@page "/Entregas"
@inject HttpClient Http
@inject IJSRuntime JS

<body onbeforeunload="DataTableRemove()">
    <div class="pricing-header px-1 py-3 pt-md-3 pb-md-4 mx-auto text-center">
        <h1 class="display-4 font-wight-bold font-color-gray">
            <strong>
                Entregas
            </strong>
        </h1>
    </div>
    <div style="margin-left:10%">
        <a class="btn btn-primary" href="AgregarEntrega"> Agregar Entrega </a>
    </div>
    <br />

    @if (entregas == null)
    {
        <text> Cargando... </text>
    }
    else if (entregas.Count == 0)
    {
        <text> No hay entregas pendientes </text>
    }
    else
    {
<div align="center">
    <table id="datatable" class="table table-striped table-bordered text-center" style="width:80%">
        <thead>
            <tr>
                <td>id</td>
                <td>Conductor</td>
                <td>Vehiculo</td>
                <td>peso</td>
                <td>costo</td>
                <td>comentarios</td>
                <td>fecha de Salida</td>
                <td>&nbsp;</td>
            </tr>
        </thead>
        <tbody>
            @foreach (var entrega in entregas)
            {
                <tr>
                    <td>@entrega.id</td>
                    <td>@entrega.chofer</td>
                    <td>@entrega.vehiculo</td>
                    <td>@entrega.peso</td>
                    <td>@entrega.costo</td>
                    <td>@entrega.comentarios</td>
                    <td>@entrega.fechaSalida.ToString("dd-MM-yyyy")</td>
                    <td>
                        <a class=" btn btn-success" href="FinalizarEntrega/@entrega.id">
                            Finalizar entrega
                        </a>
                        <button class="btn btn-danger" @onclick="(() => borrarEntrega(entrega.id)) "> Cancelar Entrega </button>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
            }

    </body>
    @code{
public List<Entrega> entregas { get; set; }

    protected override async Task OnInitializedAsync()
    {
        await cargarEntregas();
        await JS.InvokeAsync<object>("DataTableAdd");
    }

    async Task cargarEntregas()
    {
        entregas = await Http.GetJsonAsync<List<Entrega>>("Entrega");
    }

    async Task borrarEntrega(int id)
    {

    }
    }